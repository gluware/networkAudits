[{"permissionLevel":"auditManageLevel1","rules":[{"severity":"CRITICAL","name":"6.1.1.1 ACL-12 Rule - New Format","os":"ios","source":"LATEST","type":"IF_THEN","description":"ACL for SNMP MUST be on all devices ","scopeSeparateResults":true,"scope":"12$","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_only_contain_ordered_regex","value":["ip access-list standard 16"," 10 permit 10.30.143.120"," 20 permit 172.19.252.77"," 30 permit 10.200.45.22"," 40 permit 10.200.6.3"," 50 permit 172.19.28.6"," 60 permit 172.19.51.2"," 70 permit 10.23.56.6"," 80 permit 10.20.9.10"," 90 permit 10.255.64.48"," 100 permit 172.23.20.6"," 110 permit 10.7.14.3"," 120 permit 172.5.6.4"," 130 permit 10.7.14.7"," 140 permit 10.7.14.5"," 150 permit 10.7.14.7"," 160 permit 10.7.14.6"," 170 permit 10.7.14.8 0.0.0.1"," 180 permit 172.4.25.4 0.0.0.3"," 190 permit 172.4.6.8 0.0.0.3"," 200 permit 10.255.3.52 0.0.0.3"," 210 permit 10.255.16.44 0.0.0.3"," 220 permit 10.49.20.28 0.0.0.3"]}],"valid":true},"ifExpression":{"$and":[{"detectedSoftwareVersion":{"$regex":"(((16.1[1-9]+)))","$options":"mi"}}]},"conceptItem":"IOS_IpAcl"},{"severity":"CRITICAL","name":"6.1.1.1 ACL-12 Rule - Old Format","os":"ios","source":"LATEST","type":"IF_THEN","description":"ACL for SNMP MUST be on all devices ","scopeSeparateResults":true,"scope":"12$","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_only_contain_regex","value":["access-list 12 permit 10.30.143.120","access-list 12 permit 172.19.252.77","access-list 12 permit 10.200.45.22","access-list 12 permit 10.200.6.3","access-list 12 permit 172.19.28.6","access-list 12 permit 172.19.51.2","access-list 12 permit 10.23.56.6","access-list 12 permit 10.20.9.10","access-list 12 permit 10.255.64.48","access-list 12 permit 172.23.20.6","access-list 12 permit 10.7.14.3","access-list 12 permit 172.5.6.4","access-list 12 permit 10.7.14.7","access-list 12 permit 10.7.14.5","access-list 12 permit 10.7.14.7","access-list 12 permit 10.7.14.6","access-list 12 permit 10.7.14.8 0.0.0.1","access-list 12 permit 172.4.25.4 0.0.0.3","access-list 12 permit 172.4.6.8 0.0.0.3","access-list 12 permit 10.255.3.52 0.0.0.3","access-list 12 permit 10.255.16.44 0.0.0.3","access-list 12 permit 10.49.20.28 0.0.0.3","access-list 12 deny\\s+any log"]}],"valid":true},"ifExpression":{"$and":[{"detectedSoftwareVersion":{"$regex":"(((16.[6789])))","$options":"mi"}}]},"conceptItem":"IOS_IpAclNumbered"},{"severity":"CRITICAL","name":"6.1.1.2 Banner Exec","os":"ios","source":"LATEST","type":"SIMPLE","description":"Validate Banner Exec --Add variables below ","scopeSeparateResults":true,"scope":"exec","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["Hostname:{{device.detectedHostName}}e","Location: {{device.CC}}","Model: {{device.detectedSku}}"]}],"valid":true},"conceptItem":"IOS_Banner"},{"severity":"CRITICAL","name":"6.1.1.2b Banner login","os":"ios","source":"LATEST","type":"SIMPLE","description":"Validate Banner login","scopeSeparateResults":true,"scope":"login","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain","value":["banner login ^C","********************************************************************************","*                                 Warning Notice                               *","*                                                                              *","*  This system is restricted solely to ACME authorized users for  *","*  legitimate business purposes only. The actual or attempted unauthorized     *","*  access, use, or modification of this system is strictly prohibited by       *","*  ACME                                                           *","*                                                                              *","*  Unauthorized users are subject to Company disciplinary proceedings and/or   *","*  criminal and civil penalties under state, federal, or other applicable      *","*  domestic and foreign laws.                                                  *","*                                                                              *                                                                              *","********************************************************************************","^C"]}],"valid":true},"conceptItem":"IOSXE_Banner"},{"severity":"CRITICAL","name":"6.2.1.1 VTY Access List 5","os":"ios","source":"LATEST","type":"SIMPLE","description":"VTY ACL","scopeSeparateResults":true,"scope":"5$","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_ordered_regex","value":["10 permit 10.42.19.28","20 permit 156.20.46.15","30 permit 10.18.6.3","40 permit 172.26.17.10","50 permit 137.6.10.31","60 permit 172.26.25.8","70 permit 10.2.15.6","80 permit 137.23.6.6","90 permit 10.255.4.8","100 permit 137.24.5.23","110 permit 137.5.6.23","120 permit 172.5.4.80","130 permit 10.228.208.140 0.0.0.1","140 permit 172.19.208.140 0.0.0.1","150 permit 172.19.197.140 0.0.0.1","160 permit 10.255.14.244 0.0.0.3","170 permit 10.46.202.228 0.0.0.3","180 permit 10.25.33.5 0.0.0.3"]}],"valid":true},"conceptItem":"IOS_IpAcl"},{"severity":"CRITICAL","name":"6.2.1.2 VTY 0 4 Protection ","os":"ios","source":"LATEST","type":"SIMPLE","description":"vty 0 4 lines protected by an access-list","scopeSeparateResults":true,"scope":"vty 0 4","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["line vty 0 4"," access-class 5 in"," ipv6 access-class IPv6-Deny-All in"," ipv6 access-class IPv6-Deny-All out"," session-timeout 15"," exec-timeout 15 0"," password (.+)"," transport input telnet"," transport output telnet"]}],"valid":true},"conceptItem":"IOS_LineConVty"},{"severity":"CRITICAL","name":"6.2.1.3 VTY 5 15 Protection ","os":"ios","source":"LATEST","type":"SIMPLE","description":"vty 0 15 lines protected by an access-list, vty 5-15 may optionally exist","scopeSeparateResults":true,"scope":"vty 5 15","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["access-class 5 in","ipv6 access-class IPv6-Deny-All in","ipv6 access-class IPv6-Deny-All out","session-timeout 15","exec-timeout 15 0","password (.+)","transport input telnet","transport output telnet"]}],"valid":true},"conceptItem":"IOS_LineConVty"},{"severity":"CRITICAL","name":"6.2.2.1 SNMP Protection","os":"ios","source":"LATEST","type":"SIMPLE","description":"Make sure SNMP community-strings are protected by an access-list -- ADD community string below or user variable.","scopeSeparateResults":false,"scope":"snmp-server (.+)","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["snmp-server community (.+) RO ipv6 IPv6-Deny-All 12"]},{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["snmp-server group GluGroup v3 priv","snmp-server user GluUser GluGroup v3 auth sha (.+) priv aes 128 (.+) access 12","snmp-server user GluUser@gGp v3 priv context vlan-(.+)"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.2.3.1 HSRP ","os":"ios","source":"LATEST","type":"SIMPLE","description":"Check for VIP on any HSRP interface","scopeSeparateResults":true,"scope":".+","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["standby (.+) ip (.+)"]},{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_not_contain_regex","value":["standby (.+)"]}],"valid":true},"conceptItem":"IOSXE_Intf"},{"severity":"CRITICAL","name":"6.2.4.1 ACL Sanity Checking","os":"ios","source":"LATEST","type":"SIMPLE","description":"Ordered ACL lists - Example: must include deny OLD style numbered ACLs","scopeSeparateResults":false,"scope":".+","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_ordered_regex","value":["permit (.+)","deny(.+)"]}],"valid":true},"conceptItem":"IOS_IpAclNumbered"},{"severity":"CRITICAL","name":"6.2.5.1a Access List must be used -- general","os":"ios","source":"LATEST","type":"SIMPLE","description":"Undefined ACL numbered example","scopeSeparateResults":false,"scope":"(access-list 1)|(access-class)","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["access-list 5","access-class 5"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.2.5.1 Access List must be used - specific","os":"ios","source":"LATEST","type":"SIMPLE","description":"Specify all parts required - works for prefix list and classmaps also","scopeSeparateResults":false,"scope":"access-list|access-class|snmp-server","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain","value":["ip access-list standard 5","ip access-list standard 12"]},{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["access-class 4","snmp-server (.+) 12"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.2.6 Check for Unused Access-List/Class-Maps","os":"ios","source":"LATEST","type":"SIMPLE","description":"Specify if segment is present, it must be used - works for access-lists, prefix list and classmaps also - EXAMPLE","scopeSeparateResults":false,"scope":"^policy-map|^service-policy","thenExpression":{"condition":"OR","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^policy-map PMAP1","^service-policy output SP-1"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.1.1a-NTP APAC","os":"ios","source":"LATEST","type":"IF_THEN","description":"Check for ntp servers in APAC","scopeSeparateResults":false,"scope":"^ntp server","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^ntp server 128.199.18.16 prefer","^ntp server 128.6.10.80","^ntp server 128.16.101.16"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-APAC'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.1.1b-NTP Americas","os":"ios","source":"LATEST","type":"IF_THEN","description":"Check for ntp servers in Americas","scopeSeparateResults":false,"scope":"^ntp server","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^ntp server 128.16.101.16 prefer","^ntp server 128.6.10.80","^ntp server 128.199.18.16"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-AMERICAS'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.1.1c-NTP EMEA","os":"ios","source":"LATEST","type":"IF_THEN","description":"Check for ntp servers in EMEA","scopeSeparateResults":false,"scope":"^ntp server","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^ntp server 110.14.11.80 prefer","^ntp server 124.63.10.16","^ntp server 128.199.4.21"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-EMEA'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.2.1 Syslog  L2-L3","os":"ios","source":"LATEST","type":"IF_THEN_ELSE","description":"Syslog source-interface with condition","scopeSeparateResults":false,"scope":"^logging","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["logging source-interface Loopback0"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['String-DT'] %>":{"$eq":"MP"}}]},"elseExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["logging source-interface Vlan\\d+"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.2.1a Syslog APAC","os":"ios","source":"LATEST","type":"IF_THEN","description":"Syslog servers in APAC","scopeSeparateResults":false,"scope":"^logging host","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["logging host 10.10.10.10","logging host 10.20.20.20"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-APAC'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.2.1b Syslog Americas","os":"ios","source":"LATEST","type":"IF_THEN","description":"Syslog servers in Americas","scopeSeparateResults":false,"scope":"^logging host","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["logging host 172.20.20.20","logging host 172.30.20.20"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-AMERICAS'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.2.1c Syslog EMEA","os":"ios","source":"LATEST","type":"IF_THEN","description":"Syslog servers in EMEA","scopeSeparateResults":false,"scope":"^logging host","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["logging host 172.30.30.30","logging host 172.40.30.30"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['Enum-Region'] %>":{"$eq":"<%= cfMap['enum-val-EMEA'] %>"}}]},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.3.1 ACL IPv6","os":"ios","source":"LATEST","type":"SIMPLE","description":"Ordered ACL lists","scopeSeparateResults":false,"scope":"(ipv6 access-list) | (deny ipv6) ","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_ordered_regex","value":["ipv6 access-list IPv6-Deny-All"," deny ipv6 any any"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.3.1 Con 0","os":"ios","source":"LATEST","type":"SIMPLE","description":"Ordered ACL lists","scopeSeparateResults":true,"scope":"con 0","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["password .+","escape-character 3"]}],"valid":true},"conceptItem":"IOS_LineConVty"},{"severity":"CRITICAL","name":"6.3.3.1a-SNMP Security L2-L3 ACL5","os":"ios","source":"LATEST","type":"IF_THEN_ELSE","description":"SNMP server settings with condition","scopeSeparateResults":false,"scope":"^snmp-server","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^snmp-server trap-source Loopback0"]}],"valid":true},"ifExpression":{"$and":[{"customFieldValues.<%= cfMap['String-DT'] %>":{"$eq":"ROUTER"}}]},"elseExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["^snmp-server trap-source Vlan<mgmt vlan id>"]}],"valid":true},"conceptItem":null},{"severity":"CRITICAL","name":"6.3.3.1b-SNMP Security ACL5","os":"ios","source":"LATEST","type":"SIMPLE","description":"SNMP server settings","scopeSeparateResults":false,"scope":"(no snmp-server)|(snmp-server)","thenExpression":{"condition":"AND","rules":[{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_contain_regex","value":["snmp-server community cable-docsis RO ipv6 IPv6-Deny-All 84","snmp-server enable traps snmp authentication linkdown linkup coldstart warmstart","snmp-server enable traps hsrp","snmp-server enable traps envmon","snmp-server enable traps ipsla","snmp-server enable traps config","snmp-server enable traps entity","snmp-server enable traps ipmulticast"]},{"id":"latestConfig","field":"latestConfig","type":"string","input":"textarea","operator":"must_not_contain_regex","value":["snmp-server enable traps tty","snmp-server enable traps syslog"]}],"valid":true},"conceptItem":null}],"runLevel":"auditRunLevel1","name":"Standard IOS configuration Settings","description":"EXAMPLE LAN Audit","lastAuditErrorMsg":"","lastAuditDevicesSkippedCount":0}]